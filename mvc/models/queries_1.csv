num;theme;enonce;query;nb
1;;Ecrivez une requête SQL qui permette d'afficher tout le contenu de votre table. ;SELECT * FROM bd1.albums;44
2;;Donnez, pour chaque album, son isbn, son titre, son scénariste, son dessinateur ainsi que son année d'édition.;SELECT isbn, titre, scenariste, dessinateur, annee_edition FROM bd1.albums;44
3;;Quelles sont les albums édités par "Dupuis" ?;SELECT * FROM bd1.albums WHERE editeur = 'Dupuis';9
4;;Quels sont les titres des albums dont le scénariste est "Goscinny"?;SELECT DISTINCT titre FROM bd1.albums WHERE scenariste = ‘Goscinny’;10
5;;Quels sont les titres et les éditeurs des albums dont un des auteurs (scénariste, dessinateur ou coloriste) s'appelle "Uderzo"?;SELECT DISTINCT titre, editeur FROM bd1.albums WHERE scenariste = 'Uderzo' OR dessinateur = 'Uderzo' OR coloriste = 'Uderzo' ;8
6;;Quelles sont les albums pour lesquels le coloriste n'a pas été spécifié?;SELECT * FROM bd1.albums  WHERE coloriste IS NULL ;31
7;;Quels sont les éditeurs qui ont édité des albums en 1978 ?;SELECT DISTINCT editeur FROM bd1.albums WHERE annee_edition = 1978;1
8;;Quels sont les couples scénaristes-dessinateurs ayant travaillé ensemble pour l'éditeur "Dargaud"? (Attention: si le nom du dessinateur est le même que celui du scénariste, c'est que la même personne a effectué les deux tâches, et on ne parlera donc pas ;SELECT DISTINCT scenariste, dessinateur FROM bd1.albums  WHERE scenariste != dessinateur  AND editeur = 'Dargaud';3
9;;Quels sont les albums dont le scénariste et le dessinateur sont la même personne, mais qui ont été mis en couleur par quelqu'un d'autre?;SELECT * FROM bd1.albums WHERE scenariste = dessinateur AND coloriste != dessinateur;1
10;;Quels sont les albums dont le scénariste, le dessinateur et le coloriste sont la même personne?;SELECT * FROM bd1.albums WHERE scenariste = dessinateur AND coloriste = dessinateur ;9
11;;Quels sont les albums qui n'ont qu'un seul auteur? (Cela recouvre les cas de l'exercice précédent, mais il ne faut pas oublier les tuples pour lesquels un ou deux des trois attributs concernés ont la valeur NULL);SELECT * FROM bd1.albums WHERE (scenariste = dessinateur AND (coloriste = dessinateur OR coloriste IS NULL)) OR (coloriste = dessinateur AND scenariste IS NULL) OR (coloriste = scenariste AND dessinateur IS NULL) OR (dessinateur IS NOT NULL AND scenariste IS NULL AND coloriste IS NULL) OR (dessinateur IS NULL AND scenariste IS NOT NULL AND coloriste IS NULL)  OR (dessinateur IS NULL AND scenariste IS NULL AND coloriste IS NOT NULL);26
12;;Quels sont les scénaristes dont on a édité, après 1990, des œuvres qui coûtent moins de 8€?;SELECT DISTINCT scenariste FROM bd1.albums WHERE prix < 8 AND annee_edition > 1990;2
13;;Quels sont les titres édités en dehors de la décennie 1990-1999, par un éditeur autre que "Casterman", et dont le coloriste est ou bien non spécifié ou bien le même que le dessinateur?;SELECT DISTINCT titre FROM bd1.albums  WHERE (annee_edition < 1990 OR annee_edition > 1999) AND editeur != 'Casterman'  AND (coloriste IS NULL OR coloriste = dessinateur);29
14;;Quels sont les titres qui n'ont été édités ni par "Casterman", ni par "Dupuis", et qui ont, comme scénariste, dessinateur et coloriste, trois auteurs distincts?;SELECT DISTINCT titre FROM bd1.albums  WHERE (editeur != 'Casterman' AND editeur != 'Dupuis')  AND scenariste != dessinateur AND dessinateur != coloriste  AND coloriste != scenariste;1
15;;Quels sont tous les albums qui rentrent dans une des catégories suivantes au moins : albums de la série "Astérix" édités chez "Dargaud",   albums de la série "Tintin" édités chez "Casterman" ou au "Le Lombard" et   albums sans aucun auteur spécifié.;SELECT * FROM bd1.albums  WHERE (editeur = 'Dargaud' AND serie = 'Astérix') OR((editeur = 'Casterman' OR editeur = 'Le Lombard') AND serie = 'Tintin') OR (scenariste IS NULL AND coloriste IS NULL AND dessinateur IS NULL);13
16;;Lister les titres des albums qui contiennent le mot "César".;SELECT DISTINCT titre FROM bd1.albums  WHERE titre LIKE '%César%';1
17;;Lister les auteurs dont le nom commence par le mot "de" (peu importe la casse).;SELECT DISTINCT dessinateur, scenariste, coloriste FROM bd1.albums  WHERE lower(dessinateur) LIKE 'de%' OR lower(scenariste) LIKE 'de%' OR lower(coloriste) LIKE 'de%';2
18;order by;Donnez tous les titres des albums de la série "Astérix" et leur année d’édition, en ordre chronologique.;SELECT DISTINCT titre, annee_edition FROM bd1.albums  WHERE serie = 'Astérix'  ORDER BY annee_edition;8
19;order by;Donnez tous les titres des albums de la série "Astérix", en ordre alphabétique des titres.;SELECT DISTINCT titre FROM bd1.albums WHERE serie = 'Astérix' ORDER BY titre;8
20;order by;Donnez les albums (isbn, titre, nom d’éditeur et année d'édition) en classant ces données par éditeur, et pour chaque éditeur, par année d'édition.;SELECT isbn, titre, editeur, annee_edition FROM bd1.albums  ORDER BY editeur, annee_edition;44
21;order by;Donnez les titres et les prix des albums édités par "Dupuis", par ordre décroissant de prix.";SELECT DISTINCT titre, prix FROM bd1.albums  WHERE editeur = 'Dupuis'  ORDER BY prix DESC;9
22;fonctions agrégées;Quelle est la plus ancienne année d'édition de la table bd1.albums?;SELECT MIN(annee_edition) FROM bd1.albums;1947
23;fonctions agrégées;Quel est le prix de l’album le plus cher parmi ceux qui ont été dessinés par un autre dessinateur qu'"Uderzo"?;SELECT MAX(prix) FROM bd1.albums  WHERE dessinateur != 'Uderzo';14
24;fonctions agrégées;Combien y a-t-il d’albums édités chez "Casterman" ?;SELECT COUNT(*) FROM bd1.albums  WHERE editeur = 'Casterman';7
25;fonctions agrégées;Combien d’années séparent l’album le plus ancien de l’album le plus récent ?;SELECT MAX(annee_edition) - MIN(annee_edition) FROM bd1.albums;59
26;fonctions agrégées;Combien devrai-je payer si j’achète 3 exemplaires de chacun des albums édités par "Blake et Mortimer" et si le libraire m’accorde une réduction de 25% ?;SELECT 3*0.75*SUM(prix) FROM bd1.albums  WHERE editeur = 'Blake et Mortimer';216
27;fonctions agrégées;Les albums de la série "Tintin" ont-ils tous le même prix ? (le query pourrait par exemple renvoyer la valeur 1 si la réponse est oui);SELECT COUNT(distinct prix) FROM bd1.albums  WHERE serie = 'Tintin';1
28;fonctions agrégées;Combien y a-t-il de séries différentes dans la table bd1.albums?;SELECT COUNT(distinct serie) FROM bd1.albums ;10
29;fonctions agrégées;Combien y a-t-il d’albums pour lesquels la série est spécifiée ? Peut-on répondre à cette question par un query sans clause WHERE ? ;SELECT COUNT(serie) FROM bd1.albums;41
30;fonctions agrégées;Combien y a-t-il d’albums pour lesquels la série n’est pas spécifiée ? Peut-on répondre à cette question par un query sans clause WHERE?;SELECT COUNT(*) - COUNT(serie) FROM bd1.albums;3
31;fonctions agrégées;Combien y a-t-il d'albums dont un des auteurs au moins s'appelle "Uderzo", et quelles sont les dates d'édition du plus ancien et du plus récent d'entre eux?;SELECT COUNT(*), MIN(annee_edition), MAX(annee_edition)  FROM bd1.albums  WHERE (scenariste = 'Uderzo' OR dessinateur = 'Uderzo' OR coloriste = 'Uderzo');8 - 1975 - 1987
32;fonctions agrégées;Quels est le prix moyen des albums édités par "Dupuis" entre 1990 et 1999 (y compris ces deux années extrêmes) ?;SELECT AVG(prix) FROM bd1.albums  WHERE editeur = 'Dupuis' AND (annee_edition >= 1990 AND annee_edition <= 1999)  ;9
33;fonctions agrégées;Quel est le prix moyen des albums édités par "Dupuis" à l’exception des albums édités entre 1990 et 1999.;SELECT AVG(prix) FROM bd1.albums  WHERE editeur = 'Dupuis' AND (annee_edition < 1990 OR annee_edition > 1999);6.67
34;fonctions agrégées;Si je veux acheter un exemplaire de tous les albums dont le scénariste est "goscinny" et/ou le dessinateur "uderzo", combien devrai-je débourser?;SELECT SUM(prix) FROM bd1.albums  WHERE scenariste = 'Goscinny' OR dessinateur = 'Uderzo';75
35;fonctions agrégées;Si je veux acheter un exemplaire de tous les albums dont le scénariste n’est ni "goscinny" ni "uderzo", combien devrai-je débourser?;SELECT SUM(prix) FROM bd1.albums  WHERE scenariste != 'Goscinny' AND scenariste != 'Uderzo';209
